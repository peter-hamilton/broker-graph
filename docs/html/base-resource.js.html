<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: base-resource.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: base-resource.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const Resource = require('../structures/resource');
const EventEmitter = require('events').EventEmitter;
const util = require('util');

/**
 * Abstract class for wrapped resources used by broker client
 * @param  {} broker
 * @param  {} resourceType
 * @param  {} data
 */
var BaseResource = module.exports = function(broker, resourceType, data) {
  if (!broker) {
    throw new Error("Broker instance must be passed as an argument")
  }

  this._broker = broker;
  this.resourceType = resourceType;

  this._data = new Resource(data);
  this.id = this._data.id;
  this.brl = this._data.brl;
  this.key = this._data.key;
  this.static = this._data.static || false;
}

util.inherits(BaseResource, EventEmitter);

//DEPRECATED: use meta
BaseResource.prototype.get = function(key) {
  if (!this._data) {
    return null;
  }
  if (key) {
    return this
      ._data
      .arguments[key];
  }
  return this._data.arguments;
};

BaseResource.prototype.hasRelayed = function() {
  var self = this;
  var brl = self.relay
    ? self.relay.brl
    : self.brl;
  return (self.resourceType === "static") || (brl in self._broker._localRelays);
};

BaseResource.prototype.createRelay = function(props) {
  var self = this;

  var relayResource = self
    ._broker
    .share()
    .value(self.brl);
  if (props) {
    relayResource.meta(props);
  }

  return relayResource.update();
};

BaseResource.prototype.paths = function() {
  var self = this;
  var brl = self.relay
    ? self.relay.brl
    : self.brl;
  return self
    ._broker
    .paths(brl);
};

BaseResource.prototype.applicationPaths = function() {
  var self = this;
  return self
    ._broker
    .applicationPaths(self.brl);
};

BaseResource.prototype.launch = function(args) {
  var self = this;
  return self
    ._broker
    .launch(self, args);
};

BaseResource.prototype.expand = function(options) {
  var self = this;
  return self
    ._broker
    .expand(self, options);
};

BaseResource.prototype.meta = function(keys) {
  var self = this;
  if (Array.isArray(keys)) {
    var result = {};
    keys.forEach(function(key) {
      result[key] = self
        ._data
        .meta[key];
    })
    return result;
  } else if (typeof(keys) === "string") {
    return self
      ._data
      .meta[keys];
  }

  return self._data.meta;
};

BaseResource.prototype.ignore = function() {
  var self = this;
  //HACK:bad idea...
  delete self
    ._broker
    ._resourceMap[self.application.id][self.id]
  self.emit("removed", self);
  self.emit("updated", {
    type: "removed",
    value: self
  });

  self
    ._broker
    .emit("resource_updated", {
      type: "removed",
      value: self
    });
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="client.html">client</a></li></ul><h3>Classes</h3><ul><li><a href="client.Broker.html">Broker</a></li><li><a href="client.ConnectionClient.html">ConnectionClient</a></li><li><a href="client.Group.html">Group</a></li><li><a href="client.GroupSet.html">GroupSet</a></li><li><a href="client.LocalResource.html">LocalResource</a></li><li><a href="client.Query.html">Query</a></li><li><a href="client.RemoteResource.html">RemoteResource</a></li><li><a href="client.StaticResource.html">StaticResource</a></li></ul><h3>Global</h3><ul><li><a href="global.html#BaseResource">BaseResource</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Mon Mar 01 2021 17:30:49 GMT-0500 (GMT-05:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
